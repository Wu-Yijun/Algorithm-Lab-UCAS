<!DOCTYPE html>
<html>

<!-- Using Template To Render Pages

replace:
a href="javascript:;"
with:
a onClick="onCopy(this)" href="javascript:;"

modify:
a href="/d/Algorithm_2023/..."
to:
a herf="./**"

modify:
var kCodeUrl = "1/plus_min.cpp"
to:
dir of file

delete a pair of div

-->


<head>
    <link rel="stylesheet" media="all" href="theme-4.48.21.css">
    <script src="./my_scripts.js"></script>
    <script> var kCodeUrl = "06/BranchAssignment.cpp"; </script>
    <link rel="stylesheet" media="all" href="./my_tag_style.css">
</head>

<body>
    <div class="medium-9 columns">
        <div class="section visible">
            <div class="section__body">

                <ul class="problem__tags">
                    <span class="bp4-tag bp4-large bp4-minimal problem__tag-item icon icon-unordered_list mytag"
                        onclick="GotoIndex()">Go to Index</span>
                    <span class="bp4-tag bp4-large bp4-minimal problem__tag-item icon icon-reply mytag"
                        onclick="Goback()">Go back</span>
                    <span class="bp4-tag bp4-large bp4-minimal problem__tag-item icon icon-preview mytag"
                        onclick="ViewCode(kCodeUrl)">View Code</span>
                    <span class="bp4-tag bp4-large bp4-minimal problem__tag-item icon icon-refresh mytag"
                        onclick="RefreshPage()">Refresh</span>
                    <span class="bp4-tag bp4-large bp4-minimal problem__tag-item icon icon-star mytag">
                        <iframe
                            src="https://ghbtns.com/github-btn.html?user=Wu-Yijun=twbs&repo=Algorithm-Lab-UCAS&type=star&count=true"
                            frameborder="0" scrolling="0" width="50" height="20" title="GitHub">Star Me</iframe>
                    </span>
                </ul>
            </div>
        </div>
        <div class="section visible">
            <div class="section__header">
                <h1 class="section__title">
                    #C. Branch Assignment (optional)
                </h1>
                <div class="section__tools contest-problems">
                    <a href="./6A.html" class="pass ">
                        <span class="id">A</span>
                        <span class="icon icon-check"></span> </a> <a href="./6B.html" class="pass ">
                        <span class="id">B</span>
                        <span class="icon icon-check"></span> </a> <a href="./6C.html" class="pass active">
                        <span class="id">C</span>
                        <span class="icon icon-check"></span> </a>
                </div>
            </div>
            <div class="section__body">
                <ul class="problem__tags">
                    <span class="bp4-tag bp4-large bp4-minimal problem__tag-item icon icon-book">传统题</span>
                    <span class="bp4-tag bp4-large bp4-minimal problem__tag-item icon icon-stopwatch">1000ms</span>
                    <span class="bp4-tag bp4-large bp4-minimal problem__tag-item icon icon-comparison">256MiB</span>
                </ul>
            </div>
        </div>
        <div class="section visible">
            <div class="problem-content-container">
                <div class="problem-content" data-marker-enabled="">
                    <div class="section__header non-scratchpad--hide">
                        <h1 class="section__title">Branch Assignment (optional)</h1>
                    </div>
                    <div class="section__body typo" data-fragment-id="problem-description">
                        <blockquote class="note">
                            <p>该比赛已结束，您无法在比赛模式下递交该题目。您可以点击“在题库中打开”以普通模式查看和递交本题。</p>
                        </blockquote>
                        <h1 id="branch-assignment-(optional)" tabindex="-1">Branch Assignment (optional)</h1>
                        <p>选做题不计入课程分数</p>
                        <h2 id="description" tabindex="-1">Description</h2>
                        <p>The Innovative Consumer Products Company (ICPC) is planning to start a top-secret project.
                            This project consists of <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>s</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">s</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">s</span></span></span></span> subprojects. There
                            will be <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>b</mi>
                                                <mo>≥</mo>
                                                <mi>s</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">b\ge s</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span
                                            class="mord mathnormal">b</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">s</span></span></span></span> branches of ICPC
                            involved in this project and ICPC wants to assign each branch to one of the subprojects. In
                            other words, the branches will form <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>s</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">s</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">s</span></span></span></span> disjoint groups, with
                            each group in charge of a subproject.</p>
                        <p>At the end of each month, each branch will send a message to every other branch in its group
                            (a differentmessage to each branch). ICPC has a particular protocol for its communications.
                            Each branch <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>i</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">i</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6595em;"></span><span
                                            class="mord mathnormal">i</span></span></span></span> has a secret key <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <msub>
                                                    <mi>k</mi>
                                                    <mi>i</mi>
                                                </msub>
                                            </mrow>
                                            <annotation encoding="application/x-tex">k_i</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span
                                            class="mord"><span class="mord mathnormal"
                                                style="margin-right:0.03148em;">k</span><span class="msupsub"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:0.3117em;"><span
                                                                style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
                            known only to the branch and the ICPC headquarters. Assume branch <span class="katex"><span
                                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>i</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">i</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6595em;"></span><span
                                            class="mord mathnormal">i</span></span></span></span> wants to send a
                            message to branch <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>j</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">j</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span
                                            class="mord mathnormal"
                                            style="margin-right:0.05724em;">j</span></span></span></span>. Branch <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>i</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">i</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6595em;"></span><span
                                            class="mord mathnormal">i</span></span></span></span> encrypts its message
                            with its key <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <msub>
                                                    <mi>k</mi>
                                                    <mi>i</mi>
                                                </msub>
                                            </mrow>
                                            <annotation encoding="application/x-tex">k_i</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span
                                            class="mord"><span class="mord mathnormal"
                                                style="margin-right:0.03148em;">k</span><span class="msupsub"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:0.3117em;"><span
                                                                style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.
                            A trusted courier picks up this message from this branch and delivers it to the ICPC
                            headquarters. Headquarters decrypts the message with key <span class="katex"><span
                                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <msub>
                                                    <mi>k</mi>
                                                    <mi>i</mi>
                                                </msub>
                                            </mrow>
                                            <annotation encoding="application/x-tex">k_i</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span
                                            class="mord"><span class="mord mathnormal"
                                                style="margin-right:0.03148em;">k</span><span class="msupsub"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:0.3117em;"><span
                                                                style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
                            and re-encrypts it with key <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <msub>
                                                    <mi>k</mi>
                                                    <mi>j</mi>
                                                </msub>
                                            </mrow>
                                            <annotation encoding="application/x-tex">k_j</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span
                                            class="mord"><span class="mord mathnormal"
                                                style="margin-right:0.03148em;">k</span><span class="msupsub"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:0.3117em;"><span
                                                                style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                        class="mord mathnormal mtight"
                                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>.
                            The courier then delivers this newly encrypted message to branch <span class="katex"><span
                                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>j</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">j</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span
                                            class="mord mathnormal"
                                            style="margin-right:0.05724em;">j</span></span></span></span>, which
                            decrypts it with its own key <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <msub>
                                                    <mi>k</mi>
                                                    <mi>j</mi>
                                                </msub>
                                            </mrow>
                                            <annotation encoding="application/x-tex">k_j</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span
                                            class="mord"><span class="mord mathnormal"
                                                style="margin-right:0.03148em;">k</span><span class="msupsub"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:0.3117em;"><span
                                                                style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                        class="mord mathnormal mtight"
                                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>.
                            For security reasons, a courier can carry only one message at a time.</p>
                        <p>Given a road network and the locations of branches and the headquarters in this network, your
                            task is to determine the minimum total distance that the couriers will need to travel to
                            deliver all the end-of-month messages, over all possible assignments of branches to
                            subprojects.</p>
                        <h2 id="input" tabindex="-1">Input</h2>
                        <p>The first line of input contains four integers <span class="katex"><span
                                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>n</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">n</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">n</span></span></span></span>, <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>b</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">b</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6944em;"></span><span
                                            class="mord mathnormal">b</span></span></span></span>, <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>s</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">s</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">s</span></span></span></span>, and <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>r</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">r</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span class="mord mathnormal"
                                            style="margin-right:0.02778em;">r</span></span></span></span>, where <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>n</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">n</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">n</span></span></span></span> (<span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mn>2</mn>
                                                <mo>≤</mo>
                                                <mi>n</mi>
                                                <mo>≤</mo>
                                                <mn>5000</mn>
                                            </mrow>
                                            <annotation encoding="application/x-tex">2\le n\le 5000</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span
                                            class="mord">2</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut"
                                            style="height:0.7719em;vertical-align:-0.136em;"></span><span
                                            class="mord mathnormal">n</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut" style="height:0.6444em;"></span><span
                                            class="mord">5000</span></span></span></span>) is the number of
                            intersections, <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>b</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">b</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6944em;"></span><span
                                            class="mord mathnormal">b</span></span></span></span> (<span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mn>1</mn>
                                                <mo>≤</mo>
                                                <mi>b</mi>
                                                <mo>≤</mo>
                                                <mi>n</mi>
                                                <mo>−</mo>
                                                <mn>1</mn>
                                            </mrow>
                                            <annotation encoding="application/x-tex">1\le b\le n − 1</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span
                                            class="mord">1</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut"
                                            style="height:0.8304em;vertical-align:-0.136em;"></span><span
                                            class="mord mathnormal">b</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut"
                                            style="height:0.6667em;vertical-align:-0.0833em;"></span><span
                                            class="mord mathnormal">n</span><span class="mspace"
                                            style="margin-right:0.2222em;"></span><span class="mbin">−</span><span
                                            class="mspace" style="margin-right:0.2222em;"></span></span><span
                                        class="base"><span class="strut" style="height:0.6444em;"></span><span
                                            class="mord">1</span></span></span></span>) is the number of branches, <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>s</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">s</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">s</span></span></span></span> (<span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mn>1</mn>
                                                <mo>≤</mo>
                                                <mi>s</mi>
                                                <mo>≤</mo>
                                                <mi>b</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">1\le s\le b</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span
                                            class="mord">1</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut"
                                            style="height:0.7719em;vertical-align:-0.136em;"></span><span
                                            class="mord mathnormal">s</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut" style="height:0.6944em;"></span><span
                                            class="mord mathnormal">b</span></span></span></span>) is the number of
                            subprojects, and <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>r</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">r</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span class="mord mathnormal"
                                            style="margin-right:0.02778em;">r</span></span></span></span> (<span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mn>1</mn>
                                                <mo>≤</mo>
                                                <mi>r</mi>
                                                <mo>≤</mo>
                                                <mn>50000</mn>
                                            </mrow>
                                            <annotation encoding="application/x-tex">1\le r\le 50 000</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span
                                            class="mord">1</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut"
                                            style="height:0.7719em;vertical-align:-0.136em;"></span><span
                                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span><span
                                            class="mrel">≤</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span></span><span class="base"><span
                                            class="strut" style="height:0.6444em;"></span><span
                                            class="mord">50000</span></span></span></span>) is the number of roads. The
                            intersections are numbered from <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mn>1</mn>
                                            </mrow>
                                            <annotation encoding="application/x-tex">1</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6444em;"></span><span
                                            class="mord">1</span></span></span></span> through <span class="katex"><span
                                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>n</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">n</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">n</span></span></span></span>. The branches are at
                            intersections <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mn>1</mn>
                                            </mrow>
                                            <annotation encoding="application/x-tex">1</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6444em;"></span><span
                                            class="mord">1</span></span></span></span> through <span class="katex"><span
                                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>b</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">b</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6944em;"></span><span
                                            class="mord mathnormal">b</span></span></span></span>, and the headquarters
                            is at intersection <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>b</mi>
                                                <mo>+</mo>
                                                <mn>1</mn>
                                            </mrow>
                                            <annotation encoding="application/x-tex">b + 1</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span
                                            class="mord mathnormal">b</span><span class="mspace"
                                            style="margin-right:0.2222em;"></span><span class="mbin">+</span><span
                                            class="mspace" style="margin-right:0.2222em;"></span></span><span
                                        class="base"><span class="strut" style="height:0.6444em;"></span><span
                                            class="mord">1</span></span></span></span>. Each of the next <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>r</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">r</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span class="mord mathnormal"
                                            style="margin-right:0.02778em;">r</span></span></span></span> lines contains
                            three integers <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>u</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">u</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">u</span></span></span></span>, <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>v</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">v</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span class="mord mathnormal"
                                            style="margin-right:0.03588em;">v</span></span></span></span>, and <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>d</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">d</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6944em;"></span><span
                                            class="mord mathnormal">d</span></span></span></span>, indicating a one-way
                            road from intersection <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>u</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">u</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">u</span></span></span></span> to a different
                            intersection <span class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>v</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">v</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span class="mord mathnormal"
                                            style="margin-right:0.03588em;">v</span></span></span></span> (<span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mn>1</mn>
                                                <mo>≤</mo>
                                                <mi>u</mi>
                                                <mo separator="true">,</mo>
                                                <mi>v</mi>
                                                <mo>≤</mo>
                                                <mi>n</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">1\le u,v\le n</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span
                                            class="mord">1</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut"
                                            style="height:0.8304em;vertical-align:-0.1944em;"></span><span
                                            class="mord mathnormal">u</span><span class="mpunct">,</span><span
                                            class="mspace" style="margin-right:0.1667em;"></span><span
                                            class="mord mathnormal" style="margin-right:0.03588em;">v</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span><span
                                            class="mrel">≤</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span></span><span class="base"><span
                                            class="strut" style="height:0.4306em;"></span><span
                                            class="mord mathnormal">n</span></span></span></span>) of length <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mi>d</mi>
                                            </mrow>
                                            <annotation encoding="application/x-tex">d</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.6944em;"></span><span
                                            class="mord mathnormal">d</span></span></span></span> (<span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mn>0</mn>
                                                <mo>≤</mo>
                                                <mi>d</mi>
                                                <mo>≤</mo>
                                                <mn>10000</mn>
                                            </mrow>
                                            <annotation encoding="application/x-tex">0\le d\le 10 000</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span
                                            class="mord">0</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut"
                                            style="height:0.8304em;vertical-align:-0.136em;"></span><span
                                            class="mord mathnormal">d</span><span class="mspace"
                                            style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span
                                            class="mspace" style="margin-right:0.2778em;"></span></span><span
                                        class="base"><span class="strut" style="height:0.6444em;"></span><span
                                            class="mord">10000</span></span></span></span>). No ordered pair <span
                                class="katex"><span class="katex-mathml"><math
                                        xmlns="http://www.w3.org/1998/Math/MathML">
                                        <semantics>
                                            <mrow>
                                                <mo stretchy="false">(</mo>
                                                <mi>u</mi>
                                                <mo separator="true">,</mo>
                                                <mi>v</mi>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                            <annotation encoding="application/x-tex">(u, v)</annotation>
                                        </semantics>
                                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                            class="mopen">(</span><span class="mord mathnormal">u</span><span
                                            class="mpunct">,</span><span class="mspace"
                                            style="margin-right:0.1667em;"></span><span class="mord mathnormal"
                                            style="margin-right:0.03588em;">v</span><span
                                            class="mclose">)</span></span></span></span> appears more than once, and
                            from any intersection it is possible to reach every other intersection.</p>
                        <h2 id="output" tabindex="-1">Output</h2>
                        <p>Display the minimum total distance that the couriers will need to travel.</p>
                        <h2 id="samples" tabindex="-1">Samples</h2>
                        <div class="row">
                            <div class="code-toolbar medium-6 columns sample">
                                <h2>输入数据 1</h2>
                                <pre class="syntax-hl language-input1" tabindex="0"><code class="language-input1">5 4 2 10
5 2 1
2 5 1
3 5 5
4 5 0
1 5 1
2 3 1
3 2 5
2 4 5
2 1 1
3 4 2
</code></pre>
                                <div class="toolbar">
                                    <div class="toolbar-item"><a onClick="onCopy(this)" href="javascript:;">Copy</a>
                                    </div>
                                </div>
                            </div>
                            <div class="code-toolbar medium-6 columns sample">
                                <h2>输出数据 1</h2>
                                <pre class="syntax-hl language-output1" tabindex="0"><code class="language-output1">13
</code></pre>
                                <div class="toolbar">
                                    <div class="toolbar-item"><a onClick="onCopy(this)" href="javascript:;">Copy</a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="code-toolbar medium-6 columns sample">
                                <h2>输入数据 2</h2>
                                <pre class="syntax-hl language-input2" tabindex="0"><code class="language-input2">5 4 2 10
5 2 1
2 5 1
3 5 5
4 5 10
1 5 1
2 3 1
3 2 5
2 4 5
2 1 1
3 4 2
</code></pre>
                                <div class="toolbar">
                                    <div class="toolbar-item"><a onClick="onCopy(this)" href="javascript:;">Copy</a>
                                    </div>
                                </div>
                            </div>
                            <div class="code-toolbar medium-6 columns sample">
                                <h2>输出数据 2</h2>
                                <pre class="syntax-hl language-output2" tabindex="0"><code class="language-output2">24
</code></pre>
                                <div class="toolbar">
                                    <div class="toolbar-item"><a onClick="onCopy(this)" href="javascript:;">Copy</a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h2 id="hint" tabindex="-1">Hint</h2>
                        <p>**Source**: ACM-ICPC World Finals 2016</p>

                    </div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>